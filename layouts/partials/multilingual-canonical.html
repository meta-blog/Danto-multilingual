{{ $originalPage := . }}
{{ $usVersion := "" }}
{{ $currentLang := .Lang }}

{{ range .AllTranslations }}
  {{ if eq .Lang "us" }}
    {{ $usVersion = . }}
  {{ end }}
{{ end }}

{{ if $usVersion }}
  <link rel="canonical" href="{{ $usVersion.Permalink }}">
{{ else }}
  <link rel="canonical" href="{{ $originalPage.Permalink }}">
{{ end }}

{{ range .Translations }}
  <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
{{ end }}

{{ if not (eq $currentLang "us") }}
  {{ with $usVersion }}
    <link rel="alternate" hreflang="us" href="{{ .Permalink }}">
  {{ end }}
{{ end }}

<link rel="alternate" hreflang="{{ $currentLang }}" href="{{ $originalPage.Permalink }}">
<link rel="alternate" hreflang="x-default" href="{{ .Site.Home.Permalink }}">